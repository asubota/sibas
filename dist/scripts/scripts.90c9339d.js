"use strict";angular.module("sibasApp",["ui.bootstrap"]),angular.module("sibasApp").controller("MainCtrl",["$scope","Data","bsui","$location","$rootScope",function(a,b,c,d,e){a.reverse=!0,a.sortField="name",a.filtered=[],a.data=[],a.$watch("customText",function(a,b){a!==b&&d.search("search",a)}),a.$watch("type",function(a,b){a!==b&&d.search("type",a)}),b.then(function(b){a.data=b,a.filtered=b,a.types=_.uniq(_.map(b,function(a){return a.type})).sort(),c.updatePicker(),a.byType()}),a.byType=function(){a.filtered=a.type?_.filter(a.data,function(b){return b.type===a.type}):a.data},e.$on("$locationChangeSuccess",function(){var b=d.search().search,c=d.search().type;b&&(a.customText=b),c&&(a.type=c)})}]),angular.module("sibasApp").factory("Data",["$http","$q",function(a,b){var c=b.defer();return a.get("data/data.wiki.ru.json").success(function(a){c.resolve(a)}),c.promise}]),angular.module("sibasApp").service("bsui",["$timeout","$rootElement",function(a,b){var c=b.find(".bs-select");this.updatePicker=function(){a(function(){c.selectpicker("refresh")})}}]),angular.module("sibasApp").filter("regexFilter",function(){return function(a,b){var c,d;if(a)return b?(c=b.toLowerCase(),d=new RegExp([".*",c.replace(/\*/g,"."),".*"].join(""),"g"),a.filter(function(a){var b,e,f;return f=_.first(_.values(_.pick(a,"name_ru"))),f=f?d.test(f.toLowerCase()):!1,e=a.coordinates?a.coordinates.join().indexOf(c)>-1:!1,b=d.test(a.name.toLowerCase()),b||e||f})):a}});